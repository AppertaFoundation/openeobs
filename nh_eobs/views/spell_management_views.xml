<openerp>
    <data>
        <record model="ir.ui.view" id="view_spellboard_search">
            <field name="name">Spell Search View</field>
            <field name="model">nh.clinical.spellboard</field>
            <field name="arch" type="xml">
                <search string="Spell Search View">
                    <field name="patient_id"/>
                    <field name="location_id"/>
                    <field name="pos_id"/>
                    <group expand="1" string="Group By...">
                        <filter name="state" string="State" domain="[]" context="{'group_by':'state'}" help="State"/>
                    </group>
                </search>
            </field>
        </record>
        <record model="ir.ui.view" id="view_spellboard_tree">
            <field name="name">Spell Tree View</field>
            <field name="model">nh.clinical.spellboard</field>
            <field name="arch" type="xml">
                <tree string="Spell Tree View" version="7.0" delete="0">
                   <field name="patient_id"/>
                   <field name="state" />
                   <field name="location_id"/>
                   <field name="ward_id"/>
                   <field name="code"/>
                   <field name="date_started"/>
                   <field name="date_terminated"/>
                </tree>
            </field>
        </record>
        <record model="ir.ui.view" id="view_spellboard_form">
            <field name="name">Spell Form View</field>
            <field name="model">nh.clinical.spellboard</field>
            <field name="arch" type="xml">
                <form string="Spell Form View" version="7.0" delete="0">
                    <header>
                        <button name="cancel" string="Cancel Spell"  type="object" groups="nh_clinical.group_nhc_admin,nh_clinical.group_nhc_dev,nh_clinical.group_nhc_ward_manager" attrs="{'invisible': [('state','in',['new','completed','cancelled'])]}"/>
                        <button name="discharge" string="Discharge"  type="object" groups="nh_clinical.group_nhc_admin,nh_clinical.group_nhc_dev,nh_clinical.group_nhc_ward_manager" attrs="{'invisible': [('state','in',['new','completed','cancelled'])]}"/>
                        <button name="cancel_discharge" string="Cancel Discharge"  type="object" groups="nh_clinical.group_nhc_admin,nh_clinical.group_nhc_dev,nh_clinical.group_nhc_ward_manager" attrs="{'invisible': [('state','!=','completed')]}"/>
                        <button name="transfer_button" string="Transfer" type="object" groups="nh_clinical.group_nhc_admin,nh_clinical.group_nhc_dev,nh_clinical.group_nhc_ward_manager"  attrs="{'invisible': [('state','in',['new','completed','cancelled'])]}"/>
                    </header>
                    <sheet>
                        <group>
                            <field name="patient_id"/>
                            <field name="state" />
                            <field name="location_id" domain="[['usage','=','ward']]"/>
                            <field name="ward_id" attrs="{'readonly': True}" options="{'no_open': True}"/>
                            <field name="code" attrs="{'readonly': True}" options="{'no_open': True}"/>
                            <field name="date_started"/>
                            <field name="date_terminated"/>
                        </group>
                        <notebook groups="nh_clinical.group_nhc_admin,nh_clinical.group_nhc_dev">
                            <page string="Referring Doctors">
                                <group>
                                    <field name="ref_doctor_ids" nolabel="1"/>
                                </group>
                            </page>
                            <page string="Consulting Doctors">
                                <group>
                                    <field name="con_doctor_ids" nolabel="1"/>
                                </group>
                            </page>
                        </notebook>
                    </sheet>
                </form>
            </field>
        </record>

        <record model="ir.ui.view" id="view_transfer_wizard">
            <field name="name">Transfer Wizard Form</field>
            <field name="model">nh.clinical.transfer.wizard</field>
            <field name="arch" type="xml">
                <form string="Transfer Wizard Form" version="7.0" delete="0">

                    <sheet>
                        <group>
                            <field name="patient_id" attrs="{'readonly': True}" options="{'no_open': True}"/>
                            <field name="location_id" attrs="{'readonly': True}" options="{'no_open': True}"/>
                            <field name="transfer_location_id" domain="[['usage','=','ward']]"/>
                        </group>
                    </sheet>

                    <footer>
                        <button name="transfer" type="object" string="Complete Transfer" groups="nh_clinical.group_nhc_admin,nh_clinical.group_nhc_dev,nh_clinical.group_nhc_ward_manager"/>
                        <button special="cancel" string="Cancel Transfer"/>
                    </footer>
                </form>
            </field>
        </record>

        <record model="ir.actions.act_window" id="action_show_spells">
            <field name="name">Current Visits</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">nh.clinical.spellboard</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[['state','not in',['completed','cancelled']]]</field>
            <field name="search_view_id" ref="view_spellboard_search"/>
        </record>

        <record model="ir.actions.act_window.view" id="act_view_spellboard_tree">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_spellboard_tree"/>
            <field name="act_window_id" ref="action_show_spells"/>
        </record>

        <record model="ir.actions.act_window.view" id="act_view_spellboard_form">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_spellboard_form"/>
            <field name="act_window_id" ref="action_show_spells"/>
        </record>

    </data>
</openerp>